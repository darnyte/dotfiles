#!/usr/bin/env bash

# Format in Android style but use tabs
android()
{
	astyle \
		--suffix=none \
		--style=java \
		--indent=force-tab \
		--lineend=linux \
		--unpad-paren \
		--pad-header \
		--add-brackets \
		--max-code-length=78 \
		--break-after-logical \
		"$@"
}

# Format in Markus Fisch' style
#
# @param ... - source files
markusfisch()
{
	astyle \
		--suffix=none \
		--style=allman \
		--lineend=linux \
		--unpad-paren \
		--pad-paren-in \
		--indent=force-tab \
		--min-conditional-indent=1 \
		--remove-brackets \
		--max-code-length=78 \
		--break-after-logical \
		--align-pointer=name \
		--align-reference=name \
		"$@"
}

if [ "${BASH_SOURCE[0]}" == "$0" ]
then
	if (( $# < 2 ))
	then
		cat <<EOF
usage: ${0##*/} STYLE FILE...

Where STYLE can be one of the following:

EOF

		DESC=
		while read -r
		do
			case $REPLY in
				*\(\))
					[ "$DESC" ] || continue
					echo "${REPLY%(*} - $DESC"
					DESC=
					;;
				\#\ *)
					[ "$DESC" ] && continue
					DESC=${REPLY#*#}
					;;
			esac
		done < "$0"

		exit 1
	else
		STYLE=$1
		shift
		${STYLE} "$@"
	fi
fi
